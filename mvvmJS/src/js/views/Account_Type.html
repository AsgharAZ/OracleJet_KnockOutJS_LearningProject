<div class="dashboard-bg-wrapper">
  <div class="dashboard-content-box oj-hybrid-padding" style="display: flex; flex-direction: column; align-items: stretch; justify-content: flex-start;">

    <!-- Wizard progress indicator with numbers -->
    <div style="display: flex; align-items: center; justify-content: center; margin-bottom: 28px; font-size: 0.95rem; color: #666; width: 100%; max-width: 900px;">
      <!-- Stage 1 -->
      <div style="display: flex; align-items: center; gap: 10px;">
        <div style="display: flex; flex-direction: column; align-items: center;">
          <span style="display:inline-flex; align-items:center; justify-content:center; width:32px; height:32px; border-radius:50%; background:#f0f0f0; border:2px solid #bbb; color:#333; font-weight:700; font-size:1.1rem;">1</span>
          <div style="width:20px; height:3px; background:lightgreen; margin-top:6px;"></div>
        </div>
        <span style="font-weight:600; color:#333;">Account Type</span>
      </div>

      <div style="flex:0 0 32px; height:2px; background:#bbb; margin:0 8px;"></div>
      <!-- Stage 2 -->
      <div style="display: flex; align-items: center; gap: 10px;">
        <span style="display:inline-flex; align-items:center; justify-content:center; width:32px; height:32px; border-radius:50%; background:#f0f0f0; border:2px solid #bbb; color:#333; font-weight:700; font-size:1.1rem;">2</span>
        <span style="font-weight:600; color:#333;">Account Details</span>
      </div>
      <div style="flex:0 0 32px; height:2px; background:#bbb; margin:0 8px;"></div>
      <!-- Stage 3 -->
      <div style="display: flex; align-items: center; gap: 10px;">
        <span style="display:inline-flex; align-items:center; justify-content:center; width:32px; height:32px; border-radius:50%; background:#f0f0f0; border:2px solid #bbb; color:#333; font-weight:700; font-size:1.1rem;">3</span>
        <span style="font-weight:600; color:#333;">Verification</span>
      </div>
      <div style="flex:0 0 32px; height:2px; background:#bbb; margin:0 8px;"></div>
      <!-- Stage 4 -->
      <div style="display: flex; align-items: center; gap: 10px;">
        <span style="display:inline-flex; align-items:center; justify-content:center; width:32px; height:32px; border-radius:50%; background:#f0f0f0; border:2px solid #bbb; color:#333; font-weight:700; font-size:1.1rem;">4</span>
        <span style="font-weight:600; color:#333;">Login Details</span>
        <!-- <div style="width:20px; height:3px; background:lightgreen; margin-top:6px;"></div> -->
      </div>
    </div>

    <div style="display: flex; flex-direction: row; width: 100%; max-width: 900px;">
      <div style="flex: 1; display: flex; flex-direction: column; align-items: flex-start; justify-content: flex-start;">
        <!-- Title -->
        <h2 style="font-size: 1.6rem; text-align: left; font-weight: 700; margin-bottom: 18px; color:#333;">Select Account Type</h2>

        <!-- Account type options - Optimized horizontal layout -->
        <div style="display: flex; gap: 8px; margin-bottom: 26px; width: 100%; max-width: 900px; justify-content: flex-start;">
          <button type="button"
                  data-bind="click: selectIndividual, css: { 'active-account-type': selectedAccountType() === 'Individual' }"
                  style="flex:1; min-width:0; padding:10px 6px; font-size:0.85rem; font-weight:600; color:#666; border:none; border-bottom:3px solid transparent; background:#fff; cursor:pointer; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:4px;">
            <img data-bind="attr: { src: individualIcon }" style="width: 28px; height: 28px;" alt="Individual Icon" />
            <span>Individual</span>
          </button>

          <button type="button"
                  data-bind="click: selectSoleProprietor, css: { 'active-account-type': selectedAccountType() === 'Sole Proprietor' }"
                  style="flex:1; min-width:0; padding:10px 6px; font-size:0.85rem; font-weight:600; color:#666; border:none; border-bottom:3px solid transparent; background:#fff; cursor:pointer; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:4px;">
            <img data-bind="attr: { src: soleProprietorIcon }" style="width: 28px; height: 28px;" alt="Sole Proprietor Icon" />
            <span>Sole Proprietor</span>
          </button>

          <button type="button"
                  data-bind="click: selectForeignNational, css: { 'active-account-type': selectedAccountType() === 'Foreign National' }"
                  style="flex:1; min-width:0; padding:10px 6px; font-size:0.85rem; font-weight:600; color:#666; border:none; border-bottom:3px solid transparent; background:#fff; cursor:pointer; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:4px;">
            <img data-bind="attr: { src: foreignNationalIcon }" style="width: 28px; height: 28px;" alt="Foreign National Icon" />
            <span>Foreign National</span>
          </button>

          <button type="button"
                  data-bind="click: selectSavings, css: { 'active-account-type': selectedAccountType() === 'Savings' }"
                  style="flex:1; min-width:0; padding:10px 6px; font-size:0.85rem; font-weight:600; color:#666; border:none; border-bottom:3px solid transparent; background:#fff; cursor:pointer; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:4px;">
            <img data-bind="attr: { src: savingsIcon }" style="width: 28px; height: 28px;" alt="Savings Icon" />
            <span>Savings</span>
          </button>

          <button type="button"
                  data-bind="click: selectSmartWallet, css: { 'active-account-type': selectedAccountType() === 'Smart Wallet' }"
                  style="flex:1; min-width:0; padding:10px 6px; font-size:0.85rem; font-weight:600; color:#666; border:none; border-bottom:3px solid transparent; background:#fff; cursor:pointer; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:4px;">
            <img data-bind="attr: { src: smartWalletIcon }" style="width: 28px; height: 28px;" alt="Smart Wallet Icon" />
            <span>Smart Wallet</span>
          </button>
        </div>

        <!-- CNIC input - only show for Individual -->
        <div data-bind="visible: showCNICField" style="margin-bottom: 20px; width: 100%; max-width: 600px;">
          <!-- CNIC field for Individual -->
          <div data-bind="visible: showCNICField">
            <label for="cnic" style="display:block; font-size: 0.95rem; font-weight: 500; margin-bottom: 6px; color:#333;">CNIC Number</label>
            <input id="cnic" type="text" placeholder="XXXXX-XXXXXXX-X" data-bind="value: cnicNumberFormatted, event: { input: handleCNICInput }"
                   style="width: 100%; max-width: 360px; border-radius: 10px; border: 1px solid #ccc; padding: 12px 14px; font-size: 1rem; outline:none;"
                   maxlength="15">
            <div style="font-size: 0.8rem; color:#666; margin-top:6px;">Please enter your 13-digit CNIC number</div>

            <!-- CNIC Validation Message -->
            <div data-bind="visible: cnicValidationMessage, text: cnicValidationMessage"
                 style="margin-top: 8px; font-size: 0.9rem; font-weight: 500;"
                 data-bind="style: { color: isCNICValid() ? '#28a745' : '#dc3545' }">
            </div>

            <!-- Loading indicator for CNIC validation -->
            <div data-bind="visible: isValidatingCNIC" style="margin-top: 8px; display: flex; align-items: center; gap: 8px;">
              <div style="width: 16px; height: 16px; border: 2px solid #f3f3f3; border-top: 2px solid #6e1e7d; border-radius: 50%; animation: spin 1s linear infinite;"></div>
              <span style="font-size: 0.9rem; color: #6e1e7d;">Validating...</span>
            </div>
          </div>
        </div>

        <!-- Dynamic placeholder for non-Individual account types -->
        <div data-bind="visible: selectedAccountType() && selectedAccountType() !== 'Individual'" style="padding: 20px; background-color: #f8f9fa; border: 1px solid #dee2e6; border-radius: 10px; text-align: center;">
          <div style="font-size: 1.1rem; color: #6c757d; font-style: italic;" data-bind="text: placeholderText"></div>
        </div>

        <!-- Action buttons -->
        <div style="display:flex; justify-content: flex-start; gap: 18px; margin-top: 28px; width: 100%; max-width: 600px;">
          <button type="button" data-bind="click: goBack"
                  style="background:#f2f2f2; color:#333; border:none; border-radius: 10px; padding: 18px 48px; font-size: 1rem; font-weight: 600; cursor: pointer; min-width:120px;">
            Back
          </button>
          <button type="button" data-bind="click: goNext, css: { 'locked': !canProceed() }"
                  style="background:#6e1e7d; color:#fff; border:none; border-radius: 10px; padding: 18px 0; font-size: 1rem; font-weight: 600; cursor: pointer; min-width:calc(360px - 18px - 120px); width:100%;"
                  data-bind="style: { backgroundColor: canProceed() ? '#6e1e7d' : '#bbb', color: canProceed() ? '#fff' : '#fff' }">
            Next
          </button>
        </div>
      </div>

      <div style="flex: 1;"></div>

      <!-- CNIC Guidance Panel -->
      <div style="flex: 1; display: flex; justify-content: center; align-items: flex-start; margin-top:65px;">
        <div style="border:1px solid #ddd; border-radius: 12px; padding: 16px; background:#fff; width: 260px; text-align: center; box-shadow: 0 2px 6px rgba(0,0,0,0.08);">
          <img src="../../css/images/CNIC_Guidance.png" alt="CNIC Guidance" style="width:100%; border-radius:8px; margin-bottom:12px;">
          <div style="font-size: 1rem; font-weight: 600; color:#6e1e7d; margin-bottom:1px;">Find your CNIC Identity Number</div>
          <div style="font-size: 0.9rem; color:#333; line-height:1.4;">
            Permanent citizens of Pakistan can find their CNIC Identity number on their Identity Card issued by NADRA.
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
